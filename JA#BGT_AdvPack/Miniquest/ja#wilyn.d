BEGIN ~JA#WILYN~

IF ~GlobalLT("JA#ELFSONG_QUEST","GLOBAL",3) NumTimesTalkedTo(0)~ THEN JA#WILYN_1
  SAY @0
  IF ~~ THEN EXIT
END

IF ~GlobalLT("JA#ELFSONG_QUEST","GLOBAL",3) RandomNum(3,1)~ THEN JA#WILYN_2
  SAY @1
  IF ~~ THEN EXIT
END

IF ~GlobalLT("JA#ELFSONG_QUEST","GLOBAL",3) RandomNum(3,2)~ THEN JA#WILYN_3
  SAY @2
  IF ~~ THEN EXIT
END

IF ~GlobalLT("JA#ELFSONG_QUEST","GLOBAL",3) RandomNum(3,3)~ THEN JA#WILYN_4
  SAY @3
  IF ~~ THEN EXIT
END

IF ~OR(2) Global("JA#ELFSONG_QUEST","GLOBAL",3) Global("JA#ELFSONG_QUEST","GLOBAL",4)~ THEN JA#WILYN_5
  SAY @4
  IF ~Global("JA#ELFSONG_QUEST","GLOBAL",3)~ THEN REPLY @5 GOTO JA#WILYN_6
  IF ~Global("JA#ELFSONG_QUEST","GLOBAL",4)~ THEN REPLY @6 GOTO JA#WILYN_7
  IF ~~ THEN REPLY @7 EXIT
END

IF ~~ THEN JA#WILYN_6
  SAY @8
  IF ~~ THEN REPLY @9 GOTO JA#WILYN_7
END

IF ~~ THEN JA#WILYN_7
  SAY @10
  IF ~~ THEN REPLY @11 GOTO JA#WILYN_8
  IF ~~ THEN REPLY @12 GOTO JA#WILYN_9
  IF ~~ THEN REPLY @13 GOTO JA#WILYN_13
END

IF ~~ THEN JA#WILYN_8
  SAY @14
  IF ~~ THEN REPLY @15 GOTO JA#WILYN_9
  IF ~~ THEN REPLY @16 GOTO JA#WILYN_9
  IF ~~ THEN REPLY @17 GOTO JA#WILYN_12
END

IF ~~ THEN JA#WILYN_9
  SAY @18
  IF ~~ THEN REPLY @19 GOTO JA#WILYN_10
  IF ~~ THEN REPLY @20 GOTO JA#WILYN_11
  IF ~~ THEN REPLY @17 GOTO JA#WILYN_12
END

IF ~~ THEN JA#WILYN_10
  SAY @21 = @22
  IF ~~ THEN REPLY @23 GOTO JA#WILYN_17
  IF ~~ THEN REPLY @24 GOTO JA#WILYN_16
  IF ~~ THEN REPLY @25 GOTO JA#WILYN_13
END

IF ~~ THEN JA#WILYN_11
  SAY @26
  IF ~~ THEN REPLY @23 GOTO JA#WILYN_17
  IF ~~ THEN REPLY @24 GOTO JA#WILYN_16
  IF ~~ THEN REPLY @25 GOTO JA#WILYN_12
END

IF ~~ THEN JA#WILYN_12
  SAY @27
  IF ~~ THEN REPLY @28 GOTO JA#WILYN_10
  IF ~~ THEN REPLY @29 GOTO JA#WILYN_14
END

IF ~~ THEN JA#WILYN_13
  SAY @30
  IF ~~ THEN REPLY @31 GOTO JA#WILYN_14
  IF ~~ THEN REPLY @32 GOTO JA#WILYN_15
END

IF ~~ THEN JA#WILYN_14
  SAY @33
  IF ~~ THEN REPLY @34 GOTO JA#WILYN_15
END

IF ~~ THEN JA#WILYN_15
  SAY @35
  IF ~~ THEN REPLY @23 GOTO JA#WILYN_17
  IF ~~ THEN REPLY @36 GOTO JA#WILYN_16
END

IF ~~ THEN JA#WILYN_16
  SAY @37
  IF ~~ THEN REPLY @38 GOTO JA#WILYN_17
END

IF ~~ THEN JA#WILYN_17
  SAY @39 = @40 = @41
  IF ~~ THEN REPLY @42 GOTO JA#WILYN_18
END

IF ~~ THEN JA#WILYN_18
  SAY @43
  IF ~~ THEN REPLY @44 GOTO JA#WILYN_19
END

IF ~~ THEN JA#WILYN_19
  SAY @45
  IF ~~ THEN REPLY @46 GOTO JA#WILYN_20
END

IF ~~ THEN JA#WILYN_20
  SAY @47
  IF ~~ THEN DO ~SetGlobal("JA#ELFSONG_QUEST","GLOBAL",5)~ UNSOLVED_JOURNAL @1003 EXIT
END

IF ~Global("JA#ELFSONG_QUEST","GLOBAL",5)~ THEN JA#WILYN_21
  SAY @49
  IF ~~ THEN REPLY @50 EXIT
END

IF ~Global("JA#ELFSONG_QUEST","GLOBAL",6)~ THEN JA#WILYN_22
  SAY @51
  IF ~~ THEN REPLY @52 EXIT
END

IF ~GlobalGT("JA#ELFSONG_QUEST","GLOBAL",8) Global("JA#WILY2","GLOBAL",0)~ THEN JA#WILY2_1
  SAY @0
  IF ~~ THEN DO ~SetGlobal("JA#WILY2","GLOBAL",1)~ EXIT
END

IF ~GlobalGT("JA#ELFSONG_QUEST","GLOBAL",8) RandomNum(3,1)~ THEN JA#WILY2_2
  SAY @1
  IF ~~ THEN EXIT
END

IF ~GlobalGT("JA#ELFSONG_QUEST","GLOBAL",8) RandomNum(3,2)~ THEN JA#WILY2_3
  SAY @2
  IF ~~ THEN EXIT
END

IF ~GlobalGT("JA#ELFSONG_QUEST","GLOBAL",8) RandomNum(3,3)~ THEN JA#WILY2_4
  SAY @3
  IF ~~ THEN EXIT
END

// END JA#WILYN
